# CRbeam

Monte Carlo simulation of the cosmic ray and EM cascade beam propagation.

### Authors:
   Oleg Kalashev and Alexander Korochkin

### Build:

    git clone git@github.com:okolo/mcray.git
    cd mcray
    cmake src/app/crbeam
    make

### Usage example:

    ./CRbeam -z 0.43 --emax 1e18 --emin 3e11 -N 100000 -p 10 -b 12 -mf 1e-17 -mft -mfr --backgr-mult 3.35 --lminEGMF 0.06283 --lmaxEGMF 6.283 --nmodesEGMF 463

### Command line parameters:

--------------------------
### Software settings:

-h or --help
		Show help information

-log or --log
		Enable logging

-logT or --log-thread
		Log thread filter (set to -1 to disable)
		default value:	-1

-logL or --log-level
		Log level:
	Error = 0,
	Warning = 1,
	Message = 2,
	Verbose = 3
		default value:	1

-tlog or --tlog
		Log particle trajectories

-N or --nparticles
		Number of particles
		default value:	10000

-bN or --batch
		Number of particles in minibatch (0=auto)
		default value:	0

-nth or --nthreads
		Number of threads; 0=Max available
		default value:	0

### Physical settings:

-z or --z
		Source z (or maximal z if --m_z par is given)

-zf or --z-filament
		Filament z (kill protons with z less than this value)
		default value:	0.

-E or --emax
		Initial (or maximal for power law) particle energy in eV
		default value:	1e18

-e or --emin
		Minimal energy in eV
		default value:	1e11

-pl or --power
		if>0 use E^(-power) injection
		default value:	0

-es or --emin_source
		Minimal injection energy in eV (for power law injection only)
		default value:	0

-p or --primary
		Primary particle:
	Electron = 0,
	Positron = 1,
	Photon = 2,
	Neutron 9,
	Proton 10
		default value:	10

-nEM or --noEMcascade
		don't calculate spectra of electrons and photons

-m or --m_z
		if parameter is set (!=1000), use continuous source distribution ~(1+z)^m
		default value:	1000

-b or --background
		EBL used:
0 - zero,
1 - Kneiske best fit (ELMAG),
2 - Kneiske minimal (ELMAG),
3 - Inoue 2012 Baseline,
4 - Inoue 2012 lower limit,
5 - Inoue 2012 upper limit,
6 - Franceschini 2008
7 - Kneiske best fit (digitized)
8 - Kneiske minimal (digitized)
9 - Stecker 2005
10 - Stecker 2016 lower limit,
11 - Stecker 2016 upper limit,
12 - Franceschini 2017;
default value:	3

-bm or --backgr-mult
		EBL multiplier
		default value:	1

-badd or --add-backgr
		Additional matrix background file path (relative to ./tables)

-badd_p or --add-backgr-phys
		Treat additional background data as physical (not comoving) density

-bcut or --backgr-cut
		Cut EBL above this energy [eV]
		default value:	100

-mcmb or --monocmb
		Use monochromatic 6.3e-4 eV background instead of CMB

-fcmb or --fixedcmb
		use CMB with fixed temperature (1+Zmax)2.73K

-bc or --eblDeltaZconst
		EBL extension DeltaZconst param (set to negative to disable EBL extension)
		default value:	-1

-bp or --eblPowerLow
		EBL extension PowerLow param
		default value:	0

-be or --eblDeltaZexp
		EBL extension DeltaZexp param
		default value:	1

-o or --output
		Output directory path (must not exist, will be created)

-oo or --overwrite
		overwrite output dir if exists

-t or --thinning
		Alpha thinning
		default value:	0.9

-pt or --ppp-thinning
		PPP Rescale Coefficient (double > 0, actual number of secondaries per interaction)
		default value:	10

-mf or --EGMF
		Extragalactic magnetic field in Gauss
		default value:	1e-15

-mflmin or --lminEGMF
		Extragalactic magnetic field minimum scale in Mpc at z=0
		default value:	0.05

-mflmax or --lmaxEGMF
		Extragalactic magnetic field maximum scale in Mpc at z=0
		default value:	5

-mfnm or --nmodesEGMF
		Number of modes in magnetic field spectrum
		default value:	300

-mfr or --randomEGMF
		randomize EGMF (use different EGMF configurations for different initial particles)

-mft or --turbulentEGMF
		use turbulent EGMF with Kolmogorov spectrum

-ptau or --print-tau
		print tau

-os or --output-suffix
		Output dir name suffix (appended to autogenerated names)
		default value:

### New features:
### Fix random seed for reproducing results

-rseed or --random-seed
		Specify random seed for randomizer
		default value:	getting from current time

### Change source position

-srcx or --source-x
		Source X coord in kpc
		default value:	0

-srcy or --source-y
		Source Y coord in kpc
		default value:	0

-srcz or --source-z
		Source Z coord in kpc
		default value:	0

### Randomize initial direction freedom

-jet or --jet-angle
		jet scan angle of cone from 0 (|| Oz) to Pi (isotropic emission).
		Note: this param uses as cut off for non-cone jet types

-jett or --jet-theta
		jet angle between Oz and mean jet direction

-jetp or --jet-phi
		jet angle between Ox and mean jet direction

-jettp or --jet-type
		jet type:
			0 - cone type
			1 - Gauss type
			2 - von Miser-Fisher (vMF) type

-jetprm or --jet-param
		jet distribution param: 1-sigma for Gauss or kappa for vMF

### Work with magnetic field

-omf or --outmagnetic
		write magnetic field to file

-mffile or --mf-file
		Input magnetic field file. Cancel turbulent MF settings
